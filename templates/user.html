{% extends "base.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card shadow">
            <div class="card-header bg-white">
                <h3 class="mb-0">Your Profile</h3>
                <p class="text-muted mb-0">Welcome, {{ user.name }}</p>
            </div>
            <div class="card-body">
                <form method="POST">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label for="age" class="form-label">Age</label>
                            <input type="number" class="form-control" id="age" name="age" min="10" max="120" value="{{ user.age }}" required>
                        </div>
                        <div class="col-md-6">
                            <label for="gender" class="form-label">Gender</label>
                            <select class="form-select" id="gender" name="gender" required>
                                <option value="Male" {% if user.gender == 'Male' %}selected{% endif %}>Male</option>
                                <option value="Female" {% if user.gender == 'Female' %}selected{% endif %}>Female</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="height" class="form-label">Height (cm)</label>
                            <input type="number" class="form-control" id="height" name="height" min="100" max="250" value="{{ user.height }}" required>
                        </div>
                        <div class="col-md-6">
                            <label for="weight" class="form-label">Weight (kg)</label>
                            <input type="number" class="form-control" id="weight" name="weight" min="30" max="300" value="{{ user.weight }}" required>
                        </div>
                        <div class="col-12">
                            <label for="activity" class="form-label">Activity Level</label>
                            <select class="form-select" id="activity" name="activity" required>
                                <option value="Sedentary (little or no exercise)" {% if user.activity == 'Sedentary (little or no exercise)' %}selected{% endif %}>Sedentary (little or no exercise)</option>
                                <option value="Lightly active (light exercise 1-3 days/week)" {% if user.activity == 'Lightly active (light exercise 1-3 days/week)' %}selected{% endif %}>Lightly active (light exercise 1-3 days/week)</option>
                                <option value="Moderately active (moderate exercise 3-5 days/week)" {% if user.activity == 'Moderately active (moderate exercise 3-5 days/week)' %}selected{% endif %}>Moderately active (moderate exercise 3-5 days/week)</option>
                                <option value="Very active (hard exercise 6-7 days/week)" {% if user.activity == 'Very active (hard exercise 6-7 days/week)' %}selected{% endif %}>Very active (hard exercise 6-7 days/week)</option>
                                <option value="Extra active (very hard exercise & physical job)" {% if user.activity == 'Extra active (very hard exercise & physical job)' %}selected{% endif %}>Extra active (very hard exercise & physical job)</option>
                            </select>
                        </div>
                        
                        {% if bmi %}
                        <div class="col-12 mt-4">
                            <div class="alert alert-info">
                                <h5 class="mb-2">Your Health Metrics</h5>
                                <p class="mb-1">BMI: <strong>{{ "%.1f"|format(bmi) }}</strong> ({{ bmi_category }})</p>
                                <p class="mb-0">Daily Calories: <strong>{{ "%.0f"|format(tdee) }} kcal</strong></p>
                            </div>
                        </div>
                        {% endif %}
                        
                        <div class="col-12 text-center mt-4">
                            <button type="submit" class="btn btn-primary px-4">
                                <i class="bi bi-save me-2"></i>Update Profile
                            </button>
                            <a href="{{ url_for('prediction') }}" class="btn btn-success px-4 ms-2">
                                <i class="bi bi-camera me-2"></i>Analyze Food
                            </a>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}